
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="author" content="MarkdownViewer++" />
        <title>README.md</title>
        <style type="text/css">
            
/* Avoid page breaks inside the most common attributes, especially for exports (i.e. PDF) */
td, h1, h2, h3, h4, h5, p, ul, ol, li {
    page-break-inside: avoid; 
}
table, td, th {
	border-collapse: collapse;
	border: 1px solid;
}
        </style>
      </head>
    <body>
        <h1 id="simple-image-gallery">Simple Image Gallery</h1>
<img src='doc/sig_001.jpg' style='float: right;' width=300px height=auto>
List and display images by folder showing metadata like EXIF and IPTC from images.
<p>All functionallity is build in PHP, JavaScript and SQL on top of a SQLite database.</p>
<p>This is heavyly inspired by <a href="https://sye.dk/sfpg/">Single File PHP Gallery</a>, but build from scratch.
<em>Single File PHP Gallery</em> is a nice out-of-the-box gallery app. But has it's issues with handling larger collection of images (YES! I'm impatient).</p>
<p>My own collection holds more than 89,000 images in 1,700 directories (or &gt;~ 630GB).
And I do NOT want to load that onto a webserver!</p>
<h2 id="pros-and-cons-of-simple-image-gallery">Pros and cons of <strong>Simple Image Gallery</strong></h2>
<table>
<thead>
<tr>
<th>Pros</th>
<th>cons</th>
</tr>
</thead>
<tbody>
<tr>
<td>Fast loading</td>
<td>Manual rebuil and database load</td>
</tr>
<tr>
<td>Keeps you originals away from the net</td>
<td>Max display width and heigt defined by database</td>
</tr>
<tr>
<td>Watermarking in database<a id="fnref:1" href="#fn:1" class="footnote-ref"><sup>1</sup></a></td>
<td>Requires resizing of ALL images</td>
</tr>
</tbody>
</table>
<blockquote>
<p>[!WARNING]<br />
Do <em>NOT</em> any personal/private images online!!! This is <em>not</em> a security system - and you &quot;share with the world&quot; online!</p>
</blockquote>
<h2 id="demo">Demo</h2>
<p>Take a look at the latest <a href="https://gallerydemo.clicketyclick.dk">demo</a></p>
<table  width=100%>
<tr><td width=100%>
	<figure style='float: right;'>
	  <img src='doc/sig_002.jpg' width=300px height=auto>
	  <figcaption>Directory list.</figcaption>
	</figure> 
<pre><code>List of subdirectories and individual images
</code></pre>
</td></tr>
<tr><td>
	<figure style='float: right;'>
	  <img src='doc/sig_003.jpg' width=300px height=auto>
	  <figcaption>Image view.</figcaption>
	</figure> 
</td></tr>
<tr><td>
	<figure style='float: right;'>
	  <img src='doc/sig_003_iptc_exif.jpg' width=300px height=auto>
	  <figcaption>IPTC and EXIF metadata.</figcaption>
	</figure> 
</td></tr>
<tr><td>
	<figure style='float: right;'>
	  <img src='doc/sig_003_exif_array.jpg' width=300px height=auto>
	  <figcaption>EXIF array view.</figcaption>
	</figure> 
	
</td></tr>
</table>
<h2 id="setup">Setup</h2>
<pre><code>index.php *     The Gallery
version.txt *   Version identification
LICENSE         License 
.
├───config *    Configuration files.
│   └───.flags* National flags (in SVG).
├───css*        Style Sheets.
├───database*   Database file(s).
├───doc         Documentation.
│   └───HTML    Doxygen doc.
├───examples    Examples for test run
├───icons*      Icons for display.
├───js*         Javascripts.
├───lib*        Function libraries.
├───sql         SQLscript for administration.
└───util        Utilities: rebuild, reindex.
</code></pre>
<ul>
<li>Files and directories needed on web. If you only run it locally, just ignore.</li>
</ul>
<blockquote>
<p>[!CAUTION]
The directories marked * will include a default .htaccess file for Apache servers to prevent users from poking in your data file.</p>
</blockquote>
<h2 id="startup">Startup</h2>
<p>Prepare you images in a folder structure (See: <code>./examples</code>) like this:</p>
<pre><code>├───2023
│   ├───Giza
│   ├───Odense
│   └───Öland
│       ├───Borgholm1
│       └───Borgholm2
└───Externals
    ├───DanmarkSetFraLuften
    └───OdenseBilleder
        └───1943-08-19_Asylgade
</code></pre>
<p>From the root directory of the Gallery run:</p>
<pre><code class="language-console">php util/rebuild.php 
</code></pre>
<p>And the database <code>./database/data.db</code> will be populated the data from the images in <code>./examples</code>:</p>
<pre><code class="language-console"> *   @file       rebuild.php
 *   @brief      Rebuild database with files and metadata,
 *   @details    Recursive processing file tree.
 *
 *   @todo              Needs a resume action on broken rebuild (WHERE exif IS NULL)
 *
 *   @copyright  http://www.gnu.org/licenses/lgpl.txt LGPL version 3
 *   @author     Erik Bachmann &lt;ErikBachmann@ClicketyClick.dk&gt;
 *   @since      2024-11-11T06:14:36 / ErBa
 *   @version    v.0.1.0-alpha 2024-11-13T07:26:33+00:00

- Image resize type              [scale]
- Process all
- Clear tables
- // Find all image files recursive
[===============================] 100% 31/31 ./examples\Externals\...2296_9f54c9ff59_h.jpg
- Processing files               [31]
- // Write all file names to table
- Update
- // Write meta data, thumb and view for each file
[===============================] 100% 31/31 ./examples/Externals/...2296_9f54c9ff59_h.jpg     -
- Post-processing
[===============================] 100% 26/26 vacuum: --VACUUM;
- Tables created                 [0]
- Images processed               [31]
- Post processes                 [26]
- Runtime                        [00:00:07.5467638969421]
- Log                            [none]
</code></pre>
<p>You can now test the gallery by:</p>
<ol>
<li>Running php webserver:</li>
</ol>
<pre><code class="language-console">php -S localhost:8083
</code></pre>
<ol start="2">
<li>Opening a broswer window with the address: <code>http://localhost:8083/index.php</code></li>
<li>Et voila! The Gallery is up and running.</li>
</ol>
<h2 id="configuration">Configuration</h2>
<p>Suppose that you want to build your own database <code>./database/xyz</code> with your own images from <code>W:/gallery_test/</code> try setting the arguments to rebuild:</p>
<pre><code class="language-console">php util/rebuild.php -config:data:data_root=&quot;W:/gallery_test/&quot; -config:database:file_name=./database/xyz.db
</code></pre>
<p><code>config:data:data_root</code> and <code>config:database:file_name</code> are the paths to data in the configuration file <code>./config/config.json</code></p>
<p>So you can either set the arguments on the command line - OR edit the configuration file.</p>
<p>(Snap from the configuration file)</p>
<pre><code class="language-json">{
	&quot;data&quot;: {
		&quot;virtual_root&quot;: &quot;./&quot;,
		&quot;data_root&quot;: &quot;./data/&quot;,
		&quot;data_root&quot;: &quot;W:/gallery_test/&quot;,
		&quot;image_ext&quot;: [
			&quot;jpg&quot;,
			&quot;JPEG&quot;
		]
	},
	&quot;database&quot;: {
		&quot;file_name&quot;: &quot;database/data.db&quot;,
		&quot;image_ext&quot;: [
			&quot;jpg&quot;,
			&quot;JPEG&quot;
		]
	}
}
</code></pre>
<div class="footnotes">
<hr />
<ol>
<li id="fn:1">
<p>If you put a watermark into your display images, the original are unaffected.<a href="#fnref:1" class="footnote-back-ref">&#8617;</a></p>
</li>
</ol>
</div>

    </body>
</html>
            
